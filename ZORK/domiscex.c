/* defines, enums ------------------------------------------------------------- */

#define INSIDE  2048

#define F_TRAP_DOOR 2069

/*room properties bit flags*/
#define R_DESCRIBED     1  /* set when room description already printed */
#define R_BODYOFWATER   2
#define R_LIT           4  /* set when there is natural light or a light fixture */
#define R_WATERHERE     8

/*object bit flags*/

#define PROP_OPENABLE        1
#define PROP_OPEN            2
#define PROP_LIT             4
#define PROP_NODESC          8
#define PROP_NOTTAKEABLE    16
#define PROP_MOVEDDESC      32  /* set when object is first taken */
#define PROP_WEAPON        512
#define PROP_TOOL         2048

#define O_YOU 1
#define O_SWORD  61
#define O_WATER 14
#define O_HOT_BELL 19
#define O_BOTTLE 28
#define O_RUSTY_KNIFE 51
#define O_INFLATED_BOAT 39
#define O_SCEPTRE 23
#define O_KNIFE 33
#define O_AXE 21
#define O_STILETTO 60
#define O_PUNCTURED_BOAT 45
#define O_INFLATED_BOAT 39
#define O_LEAVES 44
#define O_BELL 18
#define O_CANDLES 42
#define O_BAUBLE 74
#define O_BOOK 20
#define O_MATCH 40
#define O_TUBE 67
#define O_LUNCH 17
#define O_GARLIC 26
#define O_PUTTY 68
#define O_SANDWICH_BAG 24
#define O_LAMP 36
#define O_RAISED_BASKET 8

#define R_FOREST_1 6
#define R_FOREST_2 7
#define R_FOREST_3 9
#define R_PATH 10 
#define R_UP_A_TREE 11
#define R_ENTRANCE_TO_HADES 66
#define R_WEST_OF_HOUSE 1
#define R_NORTH_OF_HOUSE 3
#define R_SOUTH_OF_HOUSE 4
#define R_EAST_OF_HOUSE 5
#define R_GRATING_CLEARING 12
#define R_CLEARING 13
#define R_LIVING_ROOM 16
#define R_TREASURE_ROOM 44
#define R_SLIDE_ROOM 110
#define R_ATTIC 15
#define R_NORTH_TEMPLE 72
#define R_KITCHEN 14
#define R_DAM_ROOM 74

/* extern data structures ---------------------------------------------------------- */
struct OBJ_STRUCT
{
  unsigned short init_loc;
  unsigned short loc;
  unsigned short size;
  unsigned short capacity;
  unsigned short order;
  unsigned short prop;
  unsigned char init_thiefvalue;
  unsigned char thiefvalue;
};
extern struct OBJ_STRUCT Obj[];

struct ROOM_STRUCT
{
  char *scenery;
  unsigned short prop;
  unsigned short init_prop;
};
extern struct ROOM_STRUCT Room[];

extern char TimePassed; /*flag: time passed during action*/

extern int ItObj, PrevItObj; /*the obj "it" refers to*/

extern unsigned char SpiritsBanished;
extern unsigned char RugMoved;
extern int ThiefDescType; /* 0: default  1: unconscious*/
extern unsigned char KitchenWindowOpen;
extern unsigned char TrapOpen;
extern unsigned char ExitFound; /* set this when player finds an exit from dungeon other than the trapdoor*/
extern int MaintenanceWaterLevel;
extern int LampTurnsLeft;
extern int CyclopsState; /* 0: default  1: hungry  2: thirsty  3: asleep  4: fled*/
extern unsigned char MirrorBroken; /* set NotLucky too*/
extern unsigned char NotLucky;
extern unsigned char GratingRevealed;
extern unsigned char GatesButton;
extern unsigned char YouAreInBoat;
extern int BellRungCountdown; /* these three are for ceremony*/
extern int BellHotCountdown;
extern unsigned char SongbirdSang;

/* extern functions ---------------------------------------------------------------- */
void PrintCompLine(char *);
void ReturnOverlay0(short);
void ReturnOverlay0_(short);

/* variables ----------------------------------------------------------------------- */

/* code ---------------------------------------------------------------------------- */

void DM_read_prayer_ext(void)
{
  TimePassed = 1;
  PrintCompLine("\x85\x70\xf4\x79\xac\x87\xa7\x73\x63\xf1\xef\xab\xa7\xa3\xb4"
"\xad\x63\x69\xd4\xa6\x73\x63\xf1\x70\x74\xb5\xf4\xa9\xec\x20\xfe\xd5\x9f\x6f"
"\x64\x61\x79\xa4\x49\xa6\xd6\x65\x6d\xa1\xbd\xb0\x9e\xd0\x70\xce\xf5\x70\x70"
"\x69\x63\xa3\x67\x61\xa7\xc5\xaa\x6d\xe2\xea\xa7\xd6\x63\x74\x73\xb5\x61\x62"
"\xd6\xe5\x2d\x6d\xa7\xe8\x64\xed\x73\x73\xb5\x8c\x81\x70\x69\x63\x6b\x84\x75"
"\x70\x8d\xcc\xc2\x70\x70\x84\xdd\xaa\x6d\xe2\xea\x6f\x62\x6a\x65\x63\x74\x73"
"\x83\x9e\x66\xa7\xe2\x20\xd7\x72\xd6\xb3\xca\x73\x69\x67\x6e\xa1\x74\xa9\x73"
"\x70\xe0\xd6\x72\xa1\xbd\x80\xcb\x8c\xdd\x80\xcc\xbf\x64\xa4\x41\xdf\xfb\x76"
"\x69\xe8\x6e\x63\x9e\xa7\x64\x69\xe7\xd1\xa1\xa2\xaf\x80\xb0\x65\xf5\x65\x66"
"\xa1\xdd\x80\xa3\x6e\x63\x69\xd4\xa6\x5a\xd3\x6b\xac\xa1\x77\xac\x9e\x6f\x62"
"\x73\x63\xd8\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_read_wooden_door_ext(void)
{
  TimePassed = 1;
  PrintCompLine("\x85\xd4\x67\xf4\x76\x97\xa1\x74\xf4\x6e\x73\xfd\xd1\x89\x22"
"\xbc\x9a\x73\x70\x61\x63\x9e\xa7\xd1\xe5\x69\xca\xe2\xec\xcb\x65\x66\xa6\x62"
"\xfd\x6e\x6b\x2e\x22");
  ReturnOverlay0_(0);
}

void DM_read_engravings_ext(void)
{
  TimePassed = 1;
  PrintCompLine("\x85\xd4\x67\xf4\x76\x97\xa1\x77\xac\x9e\xa7\x63\xb2\xd5\xa8"
"\xb4\x81\xf5\x76\x84\xc2\x63\x6b\x8a\x81\xe7\xd7\xb7\xe2\xea\x62\xc4\xad\x20"
"\xf6\x6b\xe3\x77\xb4\xcd\xb9\x83\x65\xc4\xe8\x70\x69\x63\x74\xb5\xa7\xaa\x79"
"\x6d\x62\x6f\xf5\x63\xc6\xd3\x6d\xb5\x81\xef\xf5\x65\x66\xa1\xdd\x80\xa3\x6e"
"\x63\x69\xd4\xa6\x5a\xd3\x6b\xac\x73\xa4\x53\x6b\x69\xdf\x66\x75\xdf\xc4\xa7"
"\xd1\x72\x77\x6f\xd7\xb4\xf8\xa2\x80\xb0\xe0\xda\x65\xf5\x65\x66\xa1\xbb\x9e"
"\x65\x78\x63\xac\x70\x74\xa1\x69\xdf\xfe\x74\xf4\xf0\x9c\x81\x6d\x61\x6a\xd3"
"\xda\x65\xf5\x67\x69\xa5\xa1\xd1\xed\x74\xa1\xdd\x95\xaf\x9f\x69\x6d\x65\xa4"
"\x55\x6e\x66\xd3\x74\xf6\xaf\x65\xec\xb5\xd0\xfd\xd1\xb6\x61\x67\x9e\xd6\x65"
"\x6d\xa1\xbd\xc0\x61\xd7\xb3\xca\x73\x69\xe8\xa9\xab\x96\xf9\x62\xfd\x73\x70"
"\xa0\x6d\xa5\xa1\x8c\x6a\xfe\xa6\xe0\xaa\x6b\x69\xdf\x66\x75\xdf\xc4\x65\x78"
"\x63\xb2\xd5\x80\x6d\x2e");
  ReturnOverlay0_(0);
}

void DM_whereis_forest_ext(void)
{
  PrintCompLine("\x8b\xe7\x6e\xe3\xa6\xd6\x9e\x81\x66\xd3\xbe\xa6\x66\xd3\x80\x9f\xa9\x65\x73\x2e");
  ReturnOverlay0_(0);
}

void DM_read_granite_wall_ext(void)
{
  if (Obj[O_YOU].loc == R_SLIDE_ROOM)
    PrintCompLine("\x49\xa6\xca\xec\x20\x53\x41\x59\x53\x20\x22\x47\xf4\x6e\xc7\x9e\x57\xe2\x6c\x22\x2e");
  else
    PrintCompLine("\x99\xa9\x27\xa1\xe3\xa2\x84\xbd\xda\xbf\x64\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_zorkmid_ext(void)
{
  PrintCompLine("\x85\x7a\xd3\x6b\x6d\x69\xab\x9a\x81\xf6\xc7\x8a\x63\xd8\xa9\x6e"
"\x63\xc4\xdd\x80\x20\x47\xa9\xaf\x20\x55\xb9\xac\x67\xc2\xf6\xab\x45\x6d\x70\x69\x72\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_grue_ext(void)
{
  PrintCompLine("\x85\x67\x72\x75\x9e\x9a\xd0\x73\xa7\xb2\xd1\x72\xb5\x6c\xd8\x6b"
"\x84\x70\xa9\xd6\x6e\x63\x9e\xa7\x80\xcc\xbb\x6b\xeb\xfd\x63\xbe\x8a\x81\xbf\x72"
"\xa2\xa4\x49\x74\xa1\x66\x61\x76\xd3\xc7\x9e\x64\x69\x65\xa6\x9a\x61\x64\xd7\xe5"
"\xd8\xac\x73\xb5\x62\xf7\xa8\x74\xa1\xa7\x73\xaf\x69\x61\x62\xcf\xa3\x70\xfc\xf0"
"\xd1\x87\xd1\x6d\xfc\xa9\xab\x62\xc4\xc7\xa1\x66\xbf\xb6\xdd\xcb\x69\x67\x68\x74"
"\xa4\x4e\xba\x67\x72\x75\x9e\xcd\xa1\x65\xd7\xb6\xef\xd4\xaa\xf3\xb4\x62\xc4\x81"
"\xf5\x67\x68\xa6\xdd\xcc\x61\x79\xb5\x8c\x66\x65\x77\xc0\x61\xd7\xaa\xd8\x76\x69"
"\xd7\xab\xc7\xa1\x66\xbf\x72\x73\xe1\x9e\x6a\x61\x77\xa1\xbd\x9f\x65\xdf\x80\x9f\xe2\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_whereis_zorkmid_ext(void)
{
  PrintCompLine("\x85\xef\xc5\xb7\x61\xc4\xbd\xc6\xa7\xab\x7a\xd3\x6b\x6d\x69\x64"
"\xa1\x9a\xbd\xe6\xba\xa5\xa6\x8c\xd9\x6f\x6b\xc6\xd3\x80\x6d\x2e");
  ReturnOverlay0_(0);
}

void DM_whereis_grue_ext(void)
{
  PrintCompLine("\x99\xa9\x87\xe3\xe6\x72\x75\x9e\xa0\xa9\xb5\x62\xf7\x20\x49\x27"
"\xf9\x73\xd8\x9e\x96\xa9\x87\xaf\xcb\xbf\xc5\xae\xed\xcb\xd8\x6b\x84\xa7\x80\xcc"
"\xbb\x6b\xed\x73\xa1\xed\xbb\x62\x79\xa4\x49\xb7\xa5\x6c\x64\x93\xcf\xa6\x6d\xc4"
"\xf5\x67\x68\xa6\x67\xba\xa5\xa6\x69\xd2\x49\xb7\xac\x9e\xc9\x75\x21");
  ReturnOverlay0_(0);
}

void DM_listento_troll_ext(void)
{
  PrintCompLine("\x45\xd7\x72\xc4\x73\xba\xdd\xd1\xb4\x81\x74\xc2\xdf\xaa\x61\x79"
"\xa1\x73\xe1\x65\xa2\x97\xb5\x70\xc2\x62\x61\x62\xec\x20\xf6\x63\xe1\x70\xf5\x6d"
"\xd4\x74\xbb\x79\xb5\xa7\xc0\x9a\x67\xf7\x74\xd8\xe2\x9f\xca\x67\x75\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_listento_thief_ext(void)
{
  PrintCompLine("\x85\xa2\x69\x65\xd2\x73\x61\x79\xa1\xe3\xa2\x97\xb5\xe0\x86\xc0"
"\x61\xd7\xe4\xff\xb0\xf3\xb4\x66\xd3\x6d\xe2\xec\xa8\xe5\xc2\x64\x75\x63\x65\x64\x2e");
  ReturnOverlay0_(0);
}

void DM_listento_cyclops_ext(void)
{
  PrintCompLine("\x8b\xe7\xb4\xa0\xbb\xc0\x9a\xc5\xe1\x61\xfa\xda\x75\x6d\x62\xf5\x6e\x67\x2e");
  ReturnOverlay0_(0);
}

void DM_listento_forest_ext(void)
{
  PrintCompLine("\x85\x70\xa7\xbe\x8d\x80\xc0\x65\x6d\xd9\x63\x6b\xa1\xd6\x65\xf9\xbd\xb0\x9e\x6d\xd8\x6d\xd8\x97\x2e");
  ReturnOverlay0_(0);
}

void DM_listento_songbird_ext(void)
{
  PrintCompLine("\x8b\xe7\x93\xa0\xbb\x80\xaa\xca\x67\x62\x69\x72\xab\xe3\x77\x2e");
  ReturnOverlay0_(0);
}

void DM_cross_lake_ext(void)
{
  PrintCompLine("\x49\x74\x27\xa1\xbd\xba\xf8\xe8\x89\x63\xc2\x73\x73\x2e");
  ReturnOverlay0_(0);
}

void DM_cross_stream_ext(void)
{
  PrintCompLine("\x85\xff\xa0\xb6\x73\x69\xe8\x87\xd0\x73\xa0\xac\xda\x6f\x63\x6b\xb3\xf5\x66\x66\x2e");
  ReturnOverlay0_(0);
}

void DM_cross_chasm_ext(void)
{
  PrintCompLine("\x49\x74\x27\xa1\xbd\xba\x66\xbb\x89\x6a\x75\x6d\x70\xb5\x8c\x96\xa9\x27\xa1\xe3\xb0\xf1\x64\x67\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_exorcise_ghosts_ext(void)
{
  if (SpiritsBanished == 0 &&
      Obj[O_BELL].loc == INSIDE + O_YOU &&
      Obj[O_BOOK].loc == INSIDE + O_YOU &&
      Obj[O_CANDLES].loc == INSIDE + O_YOU)
    PrintCompLine("\x8b\x6d\xfe\xa6\xfc\x72\x66\xd3\xf9\x81\x63\xac\x65\x6d\xca\x79\x2e");
  else
    PrintCompLine("\x8b\xbb\xd4\x27\xa6\x65\x71\x75\x69\x70\xfc\xab\x66\xd3\xa3\xb4\x65\x78\xd3\x63\xb2\x6d\x2e");
  ReturnOverlay0_(0);
}

void DM_raise_rug_ext(void)
{
  PrintCompText("\x85\x72\x75\xc1\x9a\xbd\xba\xa0\x61\x76\xc4\xbd\xcb\x69\x66\x74");
  if (RugMoved)
    PrintCompLine("\x2e");
  else
    PrintCompLine("\xb5\x62\xf7\xa8\xb4\x74\x72\x79\x84\xbd\x9f\x61\x6b\x9e\xc7"
"\x86\xc0\x61\xd7\xe4\xff\x69\x63\xd5\xa3\xb4\x69\x72\xa9\x67\x75\xfd\xf1\x74\xc4\xef\xed\xaf\xde\x69\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_smell_gas_ext(void)
{
  PrintCompLine("\x49\xa6\x73\x6d\x65\xdf\xa1\xf5\x6b\x9e\x63\x6f\xe2\xe6\xe0\xa8\xb4\xa0\x72\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_l_b_ext(void)
{
  PrintCompLine("\x85\x62\xe0\x6b\x65\xa6\x9a\xaf\x80\xae\x96\xb6\xd4\xab\xdd\x80\xaa\xcd\x66\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_lookin_large_bag_ext(void)
{
  if (ThiefDescType == 1) /* unconscious*/
    PrintCompLine("\x85\x62\x61\xc1\x9a\xf6\xe8\x72\xed\xaf\xde\x81\xa2\x69\x65"
"\x66\xb5\x73\xba\xca\x9e\xe7\x93\x73\x61\xc4\x77\xcd\x74\xb5\x69\xd2\xad\x79"
"\xa2\x97\xb5\x9a\xa7\x73\x69\x64\x65\x2e");
  else
    PrintCompLine("\x47\x65\x74\xf0\x9c\x63\xd9\xd6\xfb\xe3\x75\x67\xde\x77\xa5"
"\x6c\xab\xef\xa3\xe6\xe9\xab\x74\xf1\x63\x6b\x2e");
  ReturnOverlay0_(0);
}

void DM_lookthrough_grate_ext(void)
{
  if (Obj[O_YOU].loc == R_GRATING_CLEARING)
    PrintCompLine("\x8b\xd6\x9e\x64\xbb\x6b\xed\x73\xa1\xef\xd9\x77\x2e");
  else
    PrintCompLine("\x8b\xd6\x9e\x74\xa9\xbe\xa3\x62\x6f\xd7\x86\x2e");
  ReturnOverlay0_(0);
}

void DM_lookin_water_ext(void)
{
  PrintCompLine("\x49\x74\x27\xa1\x63\xcf\xbb\x8d\xee\x69\x67\x68\xa6\xef\xeb\xff\x61\x62\x6c\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_open_kit_w_ext(void)
{
  if (KitchenWindowOpen) 
    PrintCompLine("\x49\x74\x27\xa1\xe2\xa9\x61\x64\xc4\x6f\xfc\x6e\x2e");
  else
  {
    KitchenWindowOpen = 1;
    TimePassed = 1;
    PrintCompLine("\x57\xc7\xde\x67\xa9\xaf\xfb\x66\x66\xd3\x74\xb5\x8f\x6f\xfc"
"\xb4\x81\xf8\xb9\xf2\xc6\xbb\xfb\xe3\x75\x67\xde\xbd\xa3\xdf\xf2\xfb\xe5\x72\x79\x2e");
  }
  ReturnOverlay0_(0);
}

void DM_close_kit_w_ext(void)
{
  if (KitchenWindowOpen == 0) 
    PrintCompLine("\x49\x74\x27\xa1\xe2\xa9\x61\x64\xc4\x63"
"\xd9\xd6\x64\x2e");
  else
  {
    KitchenWindowOpen = 0;
    TimePassed = 1;
    PrintCompLine("\x85\xf8\xb9\xf2\xb3\xd9\xd6\xa1\x28\x6d\xd3\x9e\xbf\x73\x69\xec"
"\x95\xad\xa8\xa6\x6f\xfc\xed\x64\x29\x2e");
  }
  ReturnOverlay0_(0);
}

void DM_move_push_rug_ext(void)
{
  if (RugMoved)
    PrintCompLine("\x48\x61\x76\x84\x6d\x6f\xd7\xab\x81\xe7\x72\xfc\xa6\x70\xa9\x76"
"\x69\xa5\x73\xec\xb5\x8f\x66\xa7\xab\xc7\xa8\x6d\x70\x6f\x73\x73\x69\x62\xcf\x89"
"\x6d\x6f\xd7\xa8\xa6\x61\x67\x61\x69\x6e\x2e");
  else
  {
    RugMoved = 1;
    TimePassed = 1;

    if (TrapOpen == 0)
    {
      PrintCompLine("\x57\xc7\xde\xd0\x67\xa9\xaf\xfb\x66\x66\xd3\x74\xb5\x81"
"\x72\x75\xc1\x9a\x6d\x6f\xd7\xab\xbd\xae\xed\xaa\x69\xe8\x8a\x81\xc2\xe1\xb5"
"\xa9\xd7\xe2\x84\x81\x64\xfe\x74\xc4\x63\x6f\xd7\xb6\xdd\xa3\xb3\xd9\xd6\xab"
"\x74\xf4\x70\xcc\xe9\x72\x2e");
      ItObj = F_TRAP_DOOR;
    }
    else
      PrintCompLine("\x57\xc7\xde\xd0\x67\xa9\xaf\xfb\x66\x66\xd3\x74\xb5\x81"
"\x72\x75\xc1\x9a\x6d\x6f\xd7\xab\xbd\xae\xed\xaa\x69\xe8\x8a\x81\xc2\x6f\x6d\x2e");
  }
  ReturnOverlay0_(0);
}

void DM_open_trap_door_ext(void)
{
  if (TrapOpen)
    PrintCompLine("\x49\x74\x27\xa1\xe2\xa9\x61\x64\xc4\x6f\xfc\x6e\x2e");
  else if (Obj[O_YOU].loc == R_LIVING_ROOM)
  {
    if (RugMoved == 0)
      PrintCompLine("\x8b\x64\xca\x27\xa6\xd6\x9e\xa2\xaf\xc0\xac\x65\x21");
    else
    {
      TrapOpen = 1;
      TimePassed = 1;
      PrintCompLine("\x85\x64\xe9\xb6\xa9\x6c\x75\x63\x74\xad\x74\xec\xae\xfc"
"\x6e\xa1\xbd\xda\x65\xd7\xe2\xa3\xda\x69\x63\x6b\x65\x74\xc4\xc5\x61\x69\x72"
"\xe7\xd6\xcc\xbe\x63\xd4\x64\x84\xa7\xbd\xcc\xbb\x6b\xed\x73\x73\x2e");
    }
  }
  else /* cellar*/
  {
    if (ExitFound == 0)
      PrintCompLine("\x85\x64\xe9\xb6\x9a\xd9\x63\x6b\xd5\xc6\xc2\xf9\x61\x62"
"\x6f\x76\x65\x2e");
    else
    {
      TrapOpen = 1;
      TimePassed = 1;
      PrintCompLine("\x4f\x6b\x61\x79\x2e");
    }
  }
  ReturnOverlay0_(0);
}

void DM_close_trap_door_ext(void)
{
  if (TrapOpen == 0)
    PrintCompLine("\x49\x74\x27\xa1\xe2\xa9\x61\x64\xc4\x63\xd9\xd6\x64\x2e");
  else if (Obj[O_YOU].loc == R_LIVING_ROOM)
  {
    TrapOpen = 0;
    TimePassed = 1;
    PrintCompLine("\x85\x64\xe9\xb6\x73\xf8\xb1\xa1\x73\x68\xf7\x8d\xb3\xd9\xd6\x73\x2e");
  }
  else /* cellar*/
  {
    TrapOpen = 0;
    TimePassed = 1;

    if (ExitFound)
      PrintCompLine("\x4f\x6b\x61\x79\x2e");
    else
      PrintCompLine("\x85\x64\xe9\xb6\x63\xd9\xd6\xa1\x8c\xd9\x63\x6b\x73\x2e");
  }
  ReturnOverlay0_(0);
}

void DM_smell_sandwich_bag_ext(void)
{
  if (Obj[O_LUNCH].loc == INSIDE + O_SANDWICH_BAG)
    PrintCompLine("\x49\xa6\x73\x6d\x65\xdf\xa1\xdd\xc0\xff\xeb\x65\x70\xfc\x72\x73\x2e");
  else
    PrintCompLine("\x49\xa6\x73\x6d\x65\xdf\xa1\xe0\x86\xb7\xa5\x6c\xab\x65\x78\xfc\x63\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_raise_trap_door_ext(void)
{
  /* DM_open_trap_door(); */
  if (TrapOpen)
    PrintCompLine("\x49\x74\x27\xa1\xe2\xa9\x61\x64\xc4\x6f\xfc\x6e\x2e");
  else if (Obj[O_YOU].loc == R_LIVING_ROOM)
  {
    if (RugMoved == 0)
      PrintCompLine("\x8b\x64\xca\x27\xa6\xd6\x9e\xa2\xaf\xc0\xac\x65\x21");
    else
    {
      TrapOpen = 1;
      TimePassed = 1;
      PrintCompLine("\x85\x64\xe9\xb6\xa9\x6c\x75\x63\x74\xad\x74\xec\xae\xfc"
"\x6e\xa1\xbd\xda\x65\xd7\xe2\xa3\xda\x69\x63\x6b\x65\x74\xc4\xc5\x61\x69\x72"
"\xe7\xd6\xcc\xbe\x63\xd4\x64\x84\xa7\xbd\xcc\xbb\x6b\xed\x73\x73\x2e");
    }
  }
  else /* cellar*/
  {
    if (ExitFound == 0)
      PrintCompLine("\x85\x64\xe9\xb6\x9a\xd9\x63\x6b\xd5\xc6\xc2\xf9\x61\x62"
"\x6f\x76\x65\x2e");
    else
    {
      TrapOpen = 1;
      TimePassed = 1;
      PrintCompLine("\x4f\x6b\x61\x79\x2e");
    }
  }

  ReturnOverlay0_(0);
}

void DM_push_blue_button_ext(void)
{
  TimePassed = 1;

  if (MaintenanceWaterLevel == 0)
  {
    MaintenanceWaterLevel = 1;
    PrintCompLine("\x99\xa9\x87\xd0\x72\x75\x6d\x62\xf5\x9c\x73\xa5\xb9\x8d\xa3"
"\xaa\x74\xa9\x61\xf9\xdd\xb7\xaf\xac\xa3\x70\xfc\xbb\xa1\xbd\xb0\xd8\xc5\xc6"
"\xc2\xf9\x81\xbf\xc5\xb7\xe2\xea\xdd\x80\xda\xe9\xf9\x28\x61\x70\x70\xbb\xd4"
"\x74\xec\xb5\xd0\xcf\x61\x6b\xc0\xe0\xae\x63\x63\xd8\xa9\xab\xa7\xa3\xeb\x69"
"\xfc\x29\x2e");
  }
  else
    PrintCompLine("\x85\x62\x6c\x75\x9e\x62\xf7\xbd\xb4\x61\x70\xfc\xbb\xa1\xbd"
"\xb0\x9e\x6a\x61\x6d\x6d\x65\x64\x2e");
  ReturnOverlay0_(0);
}

void DM_wind_broken_canary_ext(void)
{
  TimePassed = 1;
  PrintCompLine("\x99\xa9\x87\xad\x20\xf6\x70\xcf\xe0\xad\xa6\x67\xf1\xb9\x84"
"\xe3\xb2\x9e\x66\xc2\xf9\xa7\x73\x69\xe8\x80\x91\xbb\x79\x2e");
  ReturnOverlay0_(0);
}

void DM_climb_m_r_ext(void)
{
  PrintCompLine("\x44\xca\x27\xa6\x8f\xef\xf5\x65\xd7\xee\x65\x3f\x82\xee\xa5"
"\xe5\x61\xa7\xa1\xbb\x9e\x69\x6d\x70\xe0\x73\x61\x62\x6c\x65\x21");
  ReturnOverlay0_(0);
}

void DM_climbup_white_cliff_ext(void)
{
  PrintCompLine("\x85\x63\xf5\x66\xd2\x9a\xbd\xba\xc5\xf3\x70\xc6\xd3\xb3\xf5\x6d\x62\x97\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_match_ext(void)
{
  if (Obj[O_MATCH].prop & PROP_LIT)
    PrintCompLine("\x85\x6d\xaf\xfa\x87\x62\xd8\x6e\x97\x2e");
  else
    PrintCompLine("\x85\x6d\xaf\xfa\x62\xe9\x6b\xa8\x73\x93\xd7\x72\xc4\xa7\xd1"
"\xa9\xc5\x97\xb5\x65\x78\x63\x65\x70\xa6\x66\xd3\xb7\xcd\x74\x27\xa1\x77\xf1\x74\xd1\xb4\xca\xa8\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_candles_ext(void)
{
  PrintCompText("\x85\xe7\xb9\xcf\xa1\xbb\x65\x20");
  if (Obj[O_CANDLES].prop & PROP_LIT)
    PrintCompLine("\x62\xd8\x6e\x97\x2e");
  else
    PrintCompLine("\xa5\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_torch_ext(void)
{
  PrintCompLine("\x85\xbd\x72\xfa\x87\x62\xd8\x6e\x97\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_thief_ext(void)
{
  PrintCompLine("\x85\xa2\x69\x65\xd2\x9a\xd0\x73\xf5\x70\xfc\x72\xc4\xfa\xbb"
"\x61\x63\xd1\xb6\xf8\xa2\xb0\xbf\x64\xc4\x65\x79\xbe\x95\xaf\xc6\xf5\xa6\x62"
"\x61\x63\x6b\x8d\xc6\xd3\xa2\xa4\x48\x9e\xe7\x72\xf1\xbe\xb5\xe2\xca\xc1\xf8"
"\xa2\xa3\xb4\xf6\x6d\xb2\x74\x61\x6b\x61\x62\xcf\xa3\x72\xc2\x67\xad\x63\x65"
"\xb5\xd0\xfd\x72\x67\x9e\x62\x61\xc1\x6f\xd7\xb6\xce\xa1\x73\x68\xa5\x6c\xe8"
"\xb6\x8c\xd0\x76\x69\x63\x69\xa5\xa1\xc5\x69\xcf\x74\xbd\xb5\x77\x68\x6f\xd6"
"\xb0\xfd\xe8\x87\x61\x69\x6d\xd5\xee\xd4\x61\x63\x97\xec\xa8\xb4\x92\xcc\x69"
"\xa9\x63\xf0\xca\xa4\x49\x27\xab\x77\xaf\xfa\xae\xf7\xa8\xd2\x49\xb7\xac\x9e\xc9\x75\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_tool_chest_ext(void)
{
  PrintCompLine("\x85\xfa\xbe\x74\xa1\xbb\x9e\xe2\xea\x65\x6d\x70\x74\x79\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_board_ext(void)
{
  PrintCompLine("\x85\x62\x6f\xbb\x64\xa1\xbb\x9e\xd6\x63\xd8\x65\xec\xc6\xe0\xd1\xed\x64\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_chain_ext(void)
{
  PrintCompLine("\x85\xfa\x61\xa7\xaa\x65\x63\xd8\xbe\xa3\xb0\xe0\x6b\x65\xa6\xf8\xa2\xa7\x80\xaa\xcd\x66\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_open_tool_chest_ext(void)
{
  PrintCompLine("\x85\xfa\xbe\x74\xa1\xbb\x9e\xe2\xa9\x61\x64\xc4\x6f\xfc\x6e\x2e");
  ReturnOverlay0_(0);
}

void DM_open_book_ext(void)
{
  PrintCompLine("\x85\x62\xe9\x6b\x87\xe2\xa9\x61\x64\xc4\x6f\xfc\xb4\xbd\xeb\x61\x67\x9e\x35\x36\x39\x2e");
  ReturnOverlay0_(0);
}

void DM_close_book_ext(void)
{
  PrintCompLine("\x41\xa1\xcd\x72\xab\xe0\x86\x9f\x72\x79\xb5\x81\x62\xe9\x6b\x91\xe3\xa6\xef\xb3\xd9\xd6\x64\x2e");
  ReturnOverlay0_(0);
}

void DM_open_boarded_window_ext(void)
{
  PrintCompLine("\x85\xf8\xb9\xf2\xa1\xbb\x9e\x62\x6f\xbb\xe8\xab\x8c\xe7\x93\xef\xae\xfc\xed\x64\x2e");
  ReturnOverlay0_(0);
}

void DM_break_boarded_window_ext(void)
{
  PrintCompLine("\x8b\xe7\x93\x62\xa9\x61\x6b\x80\xb7\xa7\x64\xf2\xa1\x6f\xfc\x6e\x2e");
  ReturnOverlay0_(0);
}

void DM_open_close_dam_ext(void)
{
  PrintCompLine("\x53\xa5\xb9\xa1\xa9\xe0\xca\x61\x62\xcf\xb5\x62\xf7\x95\x9a\xb2\x93\x68\x6f\x77\x2e");
  ReturnOverlay0_(0);
}

void DM_ring_hot_bell_ext(void)
{
  PrintCompLine("\x85\xef\xdf\x87\xbd\xba\x68\xff\x89\xa9\x61\x63\x68\x2e");
  ReturnOverlay0_(0);
}

void DM_read_button_ext(void)
{
  PrintCompLine("\x99\x79\x27\xa9\xe6\xa9\x65\x6b\x89\xc9\x75\x2e");
  ReturnOverlay0_(0);
}

void DM_raise_l_g_wall_ext(void)
{
  PrintCompLine("\x49\x74\x27\xa1\x73\x6f\xf5\xab\x67\xf4\x6e\xc7\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_raise_lower_chain_ext(void)
{
  PrintCompLine("\x50\xac\xcd\x70\xa1\x8f\x73\x68\xa5\x6c\xab\x64\xba\xa2\xaf\x89\x81\x62\xe0\x6b\x65\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_move_chain_ext(void)
{
  PrintCompLine("\x85\xfa\x61\xa7\x87\xd6\x63\xd8\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_count_candles_ext(void)
{
  PrintCompLine("\x4c\x65\x74\x27\xa1\xd6\x65\xb5\x68\xf2\xee\xad\xc4\x6f\x62"
"\x6a\x65\x63\x74\xa1\xa7\xa3\xeb\x61\x69\x72\x3f\x20\x44\xca\x27\xa6\xd1\xdf"
"\xee\x65\xb5\x49\x27\xdf\xe6\x65\xa6\x69\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_count_leaves_ext(void)
{
  PrintCompLine("\x99\xa9\xa3\xa9\x20\x36\x39\x2c\x31\x30\x35\xcb\xbf\xd7\xa1\xa0\x72\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_lamp_ext(void)
{
  PrintCompText("\x85\xfd\x6d\x70\x20");

  if (LampTurnsLeft == 0)
    PrintCompLine("\xcd\xa1\x62\xd8\xed\xab\xa5\x74\x2e");
  else if (Obj[O_LAMP].prop & PROP_LIT)
    PrintCompLine("\x9a\x6f\x6e\x2e");
  else
    PrintCompLine("\x9a\x74\xd8\xed\xab\xdd\x66\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_cyclops_ext(void)
{
  if (CyclopsState == 3)
    PrintCompLine("\x85\x63\x79\x63\xd9\x70\xa1\x9a\x73\xcf\x65\x70\x84\xf5\x6b"
"\x9e\xd0\x62\x61\x62\x79\xb5\xe2\xef\xc7\xa3\x20\xd7\x72\xc4\x75\x67\xec\xae\x6e\x65\x2e");
  else
    PrintCompLine("\x41\xc0\xf6\x67\x72\xc4\x63\x79\x63\xd9\x70\xa1\x9a\xc5\xad"
"\x64\x84\xaf\x80\xc6\xe9\xa6\xdd\x80\xaa\x74\x61\x69\x72\x73\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_white_house_ext(void)
{
  PrintCompLine("\x85\x68\xa5\xd6\x87\xd0\xef\x61\xf7\x69\x66\x75\xea\x63\x6f\xd9"
"\x6e\x69\xe2\xc0\xa5\xd6\xb7\xce\xfa\x87\x70\x61\xa7\xd1\xab\x77\xce\xd1\xa4\x49"
"\xa6\x9a\x63\xcf\xbb\x95\xaf\x80\xae\x77\xed\x72\xa1\x6d\xfe\xa6\xcd\xd7\xb0\xf3"
"\xb4\x65\x78\x74\xa9\x6d\x65\xec\xb7\xbf\x6c\xa2\x79\x2e");
  ReturnOverlay0_(0);
}

void DM_open_close_b_d_ext(void)
{
  PrintCompLine("\x85\x64\xe9\xb6\x9a\xbd\xba\xa0\x61\x76\x79\x2e");
  ReturnOverlay0_(0);
}

void DM_open_close_s_d_ext(void)
{
  PrintCompLine("\x85\x64\xe9\xb6\x77\xca\x27\xa6\x62\x75\x64\x67\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_open_close_b_of_c_ext(void)
{
  PrintCompLine("\x85\x63\x6f\xa7\xa1\xbb\x9e\x73\x61\x66\x65\xec\xa8\x6e\x73\x69"
"\xe8\x3b\x80\xa9\x27\xa1\xe3\xe4\xf3\xab\xbd\xcc\xba\xa2\x61\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_open_close_trunk_ext(void)
{
  PrintCompLine("\x85\x6a\x65\x77\x65\x6c\xa1\xbb\x9e\x73\x61\x66\x65\xec\xa8\x6e"
"\x73\x69\xe8\x3b\x80\xa9\x27\xa1\xe3\xe4\xf3\xab\xbd\xcc\xba\xa2\x61\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_open_close_large_bag_ext(void)
{
  PrintCompLine("\x47\x65\x74\xf0\x9c\x63\xd9\xd6\xfb\xe3\x75\x67\xde\x77\xa5\x6c"
"\xab\xef\xa3\xe6\xe9\xab\x74\xf1\x63\x6b\x2e");
  ReturnOverlay0_(0);
}

void DM_open_front_door_ext(void)
{
  PrintCompLine("\x85\x64\xe9\xb6\xe7\x6e\xe3\xa6\xef\xae\xfc\xed\x64\x2e");
  ReturnOverlay0_(0);
}

 
void DM_drink_water_ext(void)
{
  if (Room[Obj[O_YOU].loc].prop & R_WATERHERE)
  {
    PrintCompLine("\xbc\xad\x6b\x86\x20\xd7\x72\xc4\x6d\x75\xfa\xa4\x49\xb7\xe0"
"\xda\xaf\xa0\xb6\xa2\x69\x72\xc5\xc4\x28\x66\xc2\xf9\xe2\xea\xa2\x9a\x74\xe2"
"\x6b\x97\xb5\x70\xc2\x62\x61\x62\xec\x29\x2e");
    TimePassed = 1;
  }
  else if (Obj[O_BOTTLE].loc == Obj[O_YOU].loc ||
           Obj[O_BOTTLE].loc == INSIDE + O_YOU)
  {
    if (Obj[O_BOTTLE].loc != INSIDE + O_YOU)
      PrintCompLine("\x8b\xcd\xd7\x89\xef\xc0\x6f\x6c\x64\x84\x81\x62\xff\x74\xcf\xc6\x69\x72\x73\x74\x2e");
    else if ((Obj[O_BOTTLE].prop & PROP_OPEN) == 0)
      PrintCompLine("\xdc\x75\x27\xdf\xc0\x61\xd7\x89\x6f\xfc\xb4\x81\x62\xff\x74\xcf\xc6\x69\x72\x73\x74\x2e");
    else if (Obj[O_WATER].loc != INSIDE + O_BOTTLE)
      PrintCompLine("\x99\xa9\xa8\x73\x93\xad\xc4\x77\xaf\xac\xc0\xac\x65\x2e");
    else
    {
      PrintCompLine("\xbc\xad\x6b\x86\x20\xd7\x72\xc4\x6d\x75\xfa\xa4\x49\xb7"
"\xe0\xda\xaf\xa0\xb6\xa2\x69\x72\xc5\xc4\x28\x66\xc2\xf9\xe2\xea\xa2\x9a\x74"
"\xe2\x6b\x97\xb5\x70\xc2\x62\x61\x62\xec\x29\x2e");
      TimePassed = 1;
      Obj[O_WATER].loc = 0;      
    }
  }
  else
    PrintCompLine("\x99\xa9\xa8\x73\x93\xad\xc4\x77\xaf\xac\xc0\xac\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_break_mirror_ext(void)
{
  if (MirrorBroken)
    PrintCompLine("\x48\x61\xd7\x93\x8f\x64\xca\x9e\xd4\xa5\x67\xde\x64\x61\x6d"
"\x61\x67\x9e\xe2\xa9\x61\x64\x79\x3f");
  else
  {
    PrintCompLine("\x8b\xcd\xd7\xb0\xc2\x6b\xd4\x80\xee\x69\x72\xc2\x72\xa4\x49"
"\xc0\x6f\xfc\x86\xc0\x61\xd7\xa3\xaa\x65\xd7\xb4\x79\xbf\x72\x73\x27\xaa\x75"
"\x70\x70\xec\x8a\x67\xe9\xab\x6c\x75\x63\x6b\xc0\xad\x64\x79\x2e");
    TimePassed = 1;
    MirrorBroken = 1;
    NotLucky = 1;
  }
  ReturnOverlay0_(0);
}

void DM_lookin_mirror_ext(void)
{
  if (MirrorBroken)
    PrintCompLine("\x85\x6d\x69\x72\xc2\xb6\x9a\x62\xc2\x6b\xd4\xa8\xe5\xba\x6d"
"\xad\xc4\x70\x69\x65\x63\x65\x73\x2e");
  else
    PrintCompLine("\x99\xa9\x87\xad\x20\x75\x67\xec\xeb\xac\x73\xca\xaa\x74\xbb"
"\x84\x62\x61\x63\x6b\xa3\xa6\xc9\x75\x2e");
  ReturnOverlay0_(0);
}

void DM_lookthrough_k_w_ext(void)
{
  PrintCompText("\x8b\xe7\xb4\xd6\x65\x20");
  if (Obj[O_YOU].loc == R_KITCHEN)
    PrintCompLine("\xd0\x63\xcf\xbb\xa3\xa9\xd0\xcf\x61\x64\x84\xbd\x77\xbb\x64"
"\xa1\xd0\x66\xd3\xbe\x74\x2e");
  else
    PrintCompLine("\x77\xcd\xa6\x61\x70\xfc\xbb\xa1\xbd\xb0\x9e\xd0\x6b\xc7\xfa\x65\x6e\x2e");
  ReturnOverlay0_(0);
}

void DM_lookunder_rug_ext(void)
{
  if (RugMoved == 0 && TrapOpen == 0)
  {
    PrintCompLine("\x55\xb9\xac\xed\xaf\xde\x81\x72\x75\xc1\x9a\xd0\x63\xd9\xd6"
"\xab\x74\xf4\x70\xcc\xe9\x72\xa4\x41\xa1\x8f\x64\xc2\x70\x80\xb3\xd3\xed\xb6"
"\xdd\x80\xda\x75\x67\xb5\x81\x74\xf4\x70\xcc\xe9\xb6\x9a\xca\x63\x9e\x61\x67"
"\x61\xa7\xb3\xca\x63\xbf\xcf\xab\x66\xc2\xf9\x76\x69\x65\x77\x2e");
    TimePassed = 1;
  }
  else
    PrintCompLine("\x8b\xd6\x9e\xe3\xa2\x84\xf6\xe8\xb6\x69\x74\x2e");
  ReturnOverlay0_(0);
}

void DM_lookunder_leaves_ext(void)
{
  if (GratingRevealed == 0)
  {
    PrintCompLine("\x55\xb9\xac\xed\xaf\xde\x81\x70\x69\xcf\x8a\xcf\x61\xd7"
"\xa1\x9a\xd0\x67\xf4\xf0\xb1\xa4\x41\xa1\x8f\xa9\xcf\xe0\x9e\x81\xcf\x61\xd7"
"\x73\xb5\x81\x67\xf4\xf0\x9c\x9a\xca\x63\x9e\x61\x67\x61\xa7\xb3\xca\x63\xbf"
"\xcf\xab\x66\xc2\xf9\x76\x69\x65\x77\x2e");
    TimePassed = 1;
    GratingRevealed = 1;
    Obj[O_LEAVES].prop |= PROP_MOVEDDESC;
  }
  else
    PrintCompLine("\x8b\xd6\x9e\xe3\xa2\x84\xf6\xe8\xb6\x81\xcf\x61\xd7\x73\x2e");
  ReturnOverlay0_(0);
}

void DM_lookunder_rainbow_ext(void)
{
  PrintCompLine("\x85\x46\xf1\x67\x69\xab\x52\x69\xd7\xb6\x66\xd9\x77\xa1\xf6\xe8\xb6\x81\xf4\xa7\x62\x6f\x77\x2e");
  ReturnOverlay0_(0);
}

void DM_lookin_chimney_ext(void)
{
  PrintCompText("\x85\xfa\x69\x6d\xed\xc4\xcf\x61\x64\x73\x20");
  if (Obj[O_YOU].loc == R_KITCHEN) PrintCompText("\x64\x6f\x77\x6e");
  else                                  PrintCompText("\x75\x70");
  PrintCompLine("\x77\xbb\x64\xb5\x8c\xd9\x6f\x6b\xa1\x63\xf5\x6d\x62\x61\x62\x6c\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_k_w_ext(void)
{
  if (KitchenWindowOpen == 0)
    PrintCompLine("\x85\xf8\xb9\xf2\x87\x73\xf5\x67\x68\x74\xec\xa3\x6a\xbb\xb5\x62\xf7\xe4\xff\xfb\xe3\x75\x67\xde\xbd\xa3\xdf\xf2\xfb\xe5\x72\x79\x2e");
  else
    PrintCompLine("\x49\x74\x27\xa1\x6f\xfc\x6e\x2e");
  ReturnOverlay0_(0);
}

void DM_lookin_bag_of_coins_ext(void)
{
  PrintCompLine("\x99\xa9\xa3\xa9\xcb\xff\xa1\xdd\xb3\x6f\xa7\xa1\xa7\x80\x72\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_lookin_trunk_ext(void)
{
  PrintCompLine("\x99\xa9\xa3\xa9\xcb\xff\xa1\xdd\x20\x6a\x65\x77\x65\x6c\xa1\xa7\x80\x72\x65\x2e");
  ReturnOverlay0_(0);
}

void DM_squeeze_tube_ext(void)
{
  if (Obj[O_TUBE].loc != INSIDE + O_YOU)
    PrintCompLine("\x8b\xbb\xd4\x27\xa6\x68\x6f\x6c\x64\x84\x81\x74\x75\x62\x65\x2e");
  else if ((Obj[O_TUBE].prop & PROP_OPEN) == 0)
    PrintCompLine("\x85\x74\x75\xef\x87\x63\xd9\xd6\x64\x2e");
  else if (Obj[O_PUTTY].loc != INSIDE + O_TUBE)
    PrintCompLine("\x85\x74\x75\xef\x87\x61\x70\x70\xbb\xd4\x74\xec\xfb\x6d\x70\x74\x79\x2e");
  else
  {
    PrintCompLine("\x85\x76\xb2\x63\xa5\xa1\x6d\xaf\xac\x69\xe2\xae\x6f\x7a\xbe\xa8\xe5\xba\x92\xc0\xad\x64\x2e");
    TimePassed = 1;
    Obj[O_PUTTY].loc = INSIDE + O_YOU;
  }
  ReturnOverlay0_(0);
}

void DM_whereis_songbird_ext(void)
{
  PrintCompLine("\x85\x73\xca\x67\x62\x69\x72\xab\x9a\xe3\xa6\xa0\xa9\xb0\xf7\x87\x70\xc2\x62\x61\x62\xec\xe4\xbf\x72\x62\x79\x2e");
  ReturnOverlay0_(0);
}

void DM_examine_sword_ext(void)
{
  int glow = Obj[O_SWORD].thiefvalue;

       if (glow == 1) PrintCompLine("\xdc\xd8\xaa\x77\xd3\xab\x9a\x67\xd9\xf8"
"\x9c\xf8\xa2\xa3\xc6\x61\xa7\xa6\x62\x6c\x75\x9e\x67\xd9\x77\x2e");
  else if (glow == 2) PrintCompLine("\xdc\xd8\xaa\x77\xd3\xab\x9a\x67\xd9\xf8"
"\x9c\xd7\x72\xc4\x62\xf1\x67\x68\x74\x6c\x79\x2e");
  else                PrintCompLine("\x8b\x64\xca\x27\xa6\xd6\x9e\xad\x79\xa2"
"\x84\xf6\xfe\x75\x61\x6c\x2e");
  ReturnOverlay0(0);
}

void DM_push_brown_button_ext(void)
{
  PrintCompLine("\x43\xf5\x63\x6b\x2e");
  Room[R_DAM_ROOM].prop &= ~R_DESCRIBED;
  GatesButton = 0;
  TimePassed = 1;
  ReturnOverlay0_(0);
}

void DM_push_yellow_button_ext(void)
{
  PrintCompLine("\x43\xf5\x63\x6b\x2e");
  Room[R_DAM_ROOM].prop &= ~R_DESCRIBED;
  GatesButton = 1;
  TimePassed = 1;
  ReturnOverlay0_(0);
}

void DM_enter_inf_b_ext(void)
{
  if (Obj[O_INFLATED_BOAT].loc != Obj[O_YOU].loc)
    PrintCompLine("\x85\x62\x6f\xaf\xee\xfe\xa6\xef\xae\xb4\x81\x67\xc2\xf6\xab"
"\xbd\xb0\x9e\x62\x6f\xbb\xe8\x64\x2e");
  else if (YouAreInBoat)
    PrintCompLine("\xdc\x75\x27\xa9\xa3\x6c\xa9\x61\x64\xc4\xa7\xa8\x74\x21");
  else
  {
    int loc = INSIDE + O_YOU;

    TimePassed = 1;

    if (Obj[O_SCEPTRE].loc == loc || Obj[O_KNIFE].loc == loc || Obj[O_SWORD].loc == loc ||
        Obj[O_RUSTY_KNIFE].loc == loc || Obj[O_AXE].loc == loc || Obj[O_STILETTO].loc == loc)
    {
      PrintCompLine("\x4f\x6f\x70\x73\x21\x20\x53\xe1\x65\xa2\x84\x73\xcd\x72"
"\x70\xaa\xf3\x6d\xa1\xbd\xc0\x61\xd7\xaa\xf5\x70\xfc\xab\x8c\x70\xf6\x63\x74"
"\xd8\xd5\x80\xb0\x6f\xaf\x83\x9e\x62\x6f\xaf\xcc\x65\x66\xfd\xd1\xa1\xbd\x80"
"\xaa\xa5\xb9\xa1\xdd\xc0\xb2\x73\x97\xb5\x73\x70\xf7\xd1\xf1\xb1\xb5\x8c\x63"
"\xd8\x73\x97\x2e");
      ItObj = O_PUNCTURED_BOAT;

      Obj[O_PUNCTURED_BOAT].loc = Obj[O_INFLATED_BOAT].loc;
      Obj[O_INFLATED_BOAT].loc = 0;
    }
    else
    {
      YouAreInBoat = 1;
      Obj[O_INFLATED_BOAT].prop |= PROP_NOTTAKEABLE;
      PrintCompLine("\x4f\x6b\x61\x79\x2e");
    }
  }
  ReturnOverlay0_(0);
}

void DM_exit_inflated_boat_ext(void)
{
  if (YouAreInBoat == 0)
    PrintCompLine("\xdc\x75\x27\xa9\xe4\xff\xa8\xb4\x69\x74\x21");
  else if (Room[Obj[O_YOU].loc].prop & R_BODYOFWATER)
    PrintCompLine("\x8b\x73\x68\xa5\x6c\xab\xfd\xb9\xb0\x65\x66\xd3\x9e\x64\xb2"
"\x65\x6d\x62\xbb\x6b\x97\x2e");
  else
  {
    YouAreInBoat = 0;
    Obj[O_INFLATED_BOAT].prop &= ~PROP_NOTTAKEABLE;
    PrintCompLine("\x4f\x6b\x61\x79\x2e");
    TimePassed = 1;
  }
  ReturnOverlay0_(0);
}

void DM_move_leaves_ext(void)
{
  if (GratingRevealed == 0)
  {
    Obj[O_LEAVES].prop |= PROP_MOVEDDESC;
    GratingRevealed = 1;
    TimePassed = 1;
    PrintCompLine("\x49\xb4\x64\xb2\x74\xd8\x62\x84\x81\x70\x69\xcf\x8a\xcf\x61"
"\xd7\x73\xb5\xd0\x67\xf4\xf0\x9c\x9a\xa9\xd7\xe2\x65\x64\x2e");
  }
  else
    PrintCompLine("\x4d\x6f\x76\x84\x81\xcf\x61\xd7\xa1\xa9\xd7\xe2\xa1\xe3\xa2\x97\x2e");
  ReturnOverlay0_(0);
}

void DM_ring_bell_ext(void)
{
  TimePassed = 1;

  if (SpiritsBanished == 0 && Obj[O_YOU].loc == R_ENTRANCE_TO_HADES)
  {
    PrintCompLine("\x85\xef\xdf\xaa\x75\x64\xe8\x6e\xec\xb0\x65\x63\xe1\xbe\xda"
"\xd5\xc0\xff\x8d\xc6\xe2\x6c\xa1\xbd\x80\xe6\xc2\xf6\x64\x83\x9e\x77\xf4\xc7"
"\x68\x73\xb5\xe0\xa8\xd2\x70\xbb\xe2\x79\x7a\xd5\xb5\xc5\x6f\x70\x80\x69\xb6"
"\x6a\xf3\xf1\x9c\x8c\x73\xd9\x77\xec\x9f\xd8\xb4\xbd\xc6\x61\x63\x9e\xc9\x75"
"\xa4\x4f\xb4\x96\x69\xb6\xe0\xa0\xb4\x66\x61\x63\xbe\xb5\x81\x65\x78\x70\xa9"
"\x73\x73\x69\xca\x8a\xd0\xd9\xb1\x2d\x66\xd3\x67\xff\xd1\xb4\xd1\x72\xc2\xb6"
"\x74\x61\x6b\xbe\xaa\xcd\x70\x65\x2e");
    ItObj = O_HOT_BELL;

    Obj[O_BELL].loc = 0;
    Obj[O_HOT_BELL].loc = R_ENTRANCE_TO_HADES;

    if (Obj[O_CANDLES].loc == INSIDE + O_YOU)
    {
      PrintCompLine("\x49\xb4\x92\xb3\xca\x66\xfe\x69\xca\xb5\x81\xe7\xb9\xcf"
"\xa1\x64\xc2\x70\x89\x81\x67\xc2\xf6\xab\x28\x8c\x96\xc4\xbb\x9e\xa5\x74\x29\x2e");

      Obj[O_CANDLES].loc = R_ENTRANCE_TO_HADES;
      Obj[O_CANDLES].prop &= ~PROP_LIT;
    }

    BellRungCountdown = 6;
    BellHotCountdown = 20;
  }
  else
    PrintCompLine("\x44\x97\xb5\x64\xca\x67\x2e");

  ReturnOverlay0_(0);
}

void DM_climbthrough_crack_ext(void)
{
  PrintCompLine("\x8b\xe7\x93\x66\xc7\x95\xc2\x75\x67\xde\x81\x63\xf4\x63\x6b\x2e");
  ReturnOverlay0_(0);
}

void DM_whereis_granite_wall_ext(void)
{
  switch (Obj[O_YOU].loc)
  {
    case R_NORTH_TEMPLE:  PrintCompLine("\x85\x77\xbe\xa6\x77\xe2\xea\x9a\x73\x6f\xf5\xab\x67\xf4\x6e\xc7\x9e\xa0\x72\x65\x2e"); break;
    case R_TREASURE_ROOM: PrintCompLine("\x85\xbf\xc5\xb7\xe2\xea\x9a\x73\x6f\xf5\xab\x67\xf4\x6e\xc7\x9e\xa0\x72\x65\x2e"); break;
    case R_SLIDE_ROOM:    PrintCompLine("\x49\xa6\xca\xec\x20\x53\x41\x59\x53\x20\x22\x47\xf4\x6e\xc7\x9e\x57\xe2\x6c\x22\x2e");       break;
  }
  ReturnOverlay0_(0);
}

void DM_whereis_white_house_ext(void)
{
  switch (Obj[O_YOU].loc)
  {
    case R_KITCHEN:
    case R_LIVING_ROOM:
    case R_ATTIC:
      PrintCompLine("\x57\x68\xc4\xe3\xa6\x66\xa7\xab\x92\xb0\xf4\xa7\x73\x3f"); /* never printed because house is not in these locations*/
    break;

    case R_EAST_OF_HOUSE:
    case R_WEST_OF_HOUSE:
    case R_NORTH_OF_HOUSE:
    case R_SOUTH_OF_HOUSE:
      PrintCompLine("\x49\x74\x27\xa1\xf1\x67\x68\xa6\xa0\x72\x65\x21");
    break;

    case R_CLEARING: PrintCompLine("\x49\xa6\xd6\x65\x6d\xa1\xbd\xb0\x9e\xbd\x80\xb7\xbe\x74\x2e");       break;
    default:            PrintCompLine("\x49\xa6\x77\xe0\xc0\xac\x9e\x6a\xfe\xa6\xd0\x6d\xa7\xf7\x9e\x61\x67\x6f\x2e\x2e\x2e\x2e"); break;
  }
  ReturnOverlay0_(0);
}

void EatFood(int obj, char *msg)
{
  if (Obj[obj].loc != INSIDE + O_YOU)
    PrintCompLine("\xdc\x75\x27\xa9\xe4\xff\xc0\x6f\x6c\x64\x84\xa2\x61\x74\x2e");
  else
  {
    PrintLine(msg);
    TimePassed = 1;
    Obj[obj].loc = 0;
  }
}

void DM_eat_lunch_ext(void)
{
  EatFood(O_LUNCH, "Thank you very much. It really hit the spot.");
  ReturnOverlay0_(0);
}

void DM_eat_garlic_ext(void)
{
  EatFood(O_GARLIC, "What the heck! You won't make friends this way, but nobody around here is too friendly anyhow. Gulp!");
  ReturnOverlay0_(0);
}

int AreYouInForest(void)
{
  switch (Obj[O_YOU].loc)
  {
    case R_FOREST_1:
    case R_FOREST_2:
    case R_FOREST_3:
    case R_PATH:
    case R_UP_A_TREE:
      return 1;

    default:
      return 0;
  }
}

void DM_wind_canary_ext(void)
{
  TimePassed = 1;

  if (SongbirdSang == 0 && AreYouInForest())
  {
    SongbirdSang = 1;
    PrintCompLine("\x85\xe7\x6e\xbb\xc4\xfa\x69\x72\x70\x73\xb5\x73\xf5\x67\x68"
"\x74\xec\xae\x66\x66\x2d\x6b\x65\x79\xb5\xad\xa3\xf1\xd0\x66\xc2\xf9\xd0\x66"
"\xd3\x67\xff\xd1\xb4\x6f\xfc\xf4\xa4\x46\xc2\xf9\xa5\xa6\xdd\x80\xe6\xa9\xd4"
"\xac\xc4\x66\xf5\xbe\xa3\xcb\x6f\xd7\xec\xaa\xca\x67\x62\x69\x72\x64\xa4\x49"
"\xa6\xfc\x72\xfa\xbe\xae\xb4\xd0\xf5\x6d\x62\x20\x6a\xfe\xa6\x6f\xd7\xb6\x92"
"\xc0\xbf\xab\x8c\x6f\xfc\x6e\xa1\xc7\xa1\xef\x61\x6b\x89\x73\x97\xa4\x41\xa1"
"\xc7\xcc\x6f\xbe\xaa\xba\xd0\xef\x61\xf7\x69\x66\x75\xea\x62\xf4\x73\xa1\x62"
"\x61\x75\x62\xcf\xcc\xc2\x70\xa1\x66\xc2\xf9\xc7\xa1\x6d\xa5\xa2\xb5\x62\xa5"
"\x6e\x63\xbe\xae\x66\xd2\x81\xbd\x70\x8a\x92\xc0\xbf\x64\xb5\x8c\xfd\xb9\xa1"
"\x67\xf5\x6d\x6d\xac\x84\xa7\x80\xe6\xf4\x73\x73\xa4\x41\xa1\x81\xe7\x6e\xbb"
"\xc4\xf8\xb9\xa1\x64\xf2\x6e\xb5\x81\x73\xca\x67\x62\x69\x72\xab\x66\xf5\xbe"
"\xa3\x77\x61\x79\x2e");

    if (Obj[O_YOU].loc == R_UP_A_TREE)
      Obj[O_BAUBLE].loc = R_PATH;
    else
      Obj[O_BAUBLE].loc = Obj[O_YOU].loc;
  }
  else
    PrintCompLine("\x85\xe7\x6e\xbb\xc4\xfa\x69\x72\x70\xa1\x62\xf5\x96\xec\xb5"
"\x69\xd2\x73\xe1\x65\x77\xcd\xa6\xf0\x6e\x6e\x69\xec\xb5\x66\xd3\xa3\xaa\x68"
"\xd3\xa6\xf0\x6d\x65\x2e");

  ReturnOverlay0_(0);
}


